{% extends "base/base.html" %}
{% load static %}

{% block title %}Dashboard - My Notes{% endblock %}

{% block head %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'core/css/custom_dashboard.css' %}" />
{% endblock %}

{% block content %}
<div class="container dashboard-container">
  <h1 class="dashboard-title">Welcome to My Notes!</h1>

  <!-- My Notes -->
  <div class="notes-section my-notes-section">
    <h2 class="section-title"><i class="fas fa-sticky-note"></i> My Notes</h2>
    <div class="note-grid">
      {% if notes %}
        {% for note in notes %}
          <div class="note-card">
            <h3 class="note-card-title">{{ note.title }}</h3>
            <p class="note-card-content">{{ note.content|truncatechars:200 }}</p>
            <div class="note-card-meta">
              <span>Created by: {{ note.create_by.username }}</span>
              <span>Created at: {{ note.created_at|date:"F j, Y H:i" }}</span>
              <span>Last updated: {{ note.updated_at|date:"F j, Y H:i" }}</span>
            </div>
            <div class="note-card-actions">
              <a href="{% url 'edit_note' note.id %}" class="btn btn-sm btn-info">
                <i class="fas fa-edit"></i> Sửa
              </a>
              <a href="{% url 'delete_note' note.id %}" class="btn btn-sm btn-danger">
                <i class="fas fa-trash-alt"></i> Xóa
              </a>
              <a href="{% url 'share_note' note.id %}" class="btn btn-sm btn-success">
                <i class="fas fa-share-alt"></i> Chia sẻ
              </a>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p class="no-notes-message">
          <a href="{% url 'create_note' %}">You don't have any notes yet. Start by adding a new one!</a>
        </p>
      {% endif %}
    </div>
  </div>

  <!-- Shared Notes -->
  <div class="notes-section shared-notes-section mt-5">
    <h2 class="section-title"><i class="fas fa-share-alt"></i> Notes Shared with Me</h2>
    <div class="note-grid">
      {% if shared_notes %}
        {% for shared in shared_notes %}
          <div class="note-card shared-note-card">
            <h3 class="note-card-title">{{ shared.note.title }}</h3>
            <p class="note-card-content">{{ shared.note.content|truncatechars:200 }}</p>
            <div class="note-card-meta">
              <span>Shared by: {{ shared.share_by.username }}</span>
              <span>Created at: {{ shared.note.created_at|date:"F j, Y H:i" }}</span>
              <span>Last updated: {{ shared.note.updated_at|date:"F j, Y H:i" }}</span>
            </div>
            <div class="note-card-actions">
              <a href="{% url 'view_note' shared.note.id %}" class="btn btn-sm btn-primary">
                <i class="fas fa-eye"></i> Xem
              </a>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p class="no-notes-message">No notes have been shared with you yet.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}

{% block script %}
<script src="{% static 'core/js/dashboardScript.js' %}"></script>
{% endblock %}
